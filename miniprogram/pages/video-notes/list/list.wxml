<!--pages/video-notes/list/list.wxml-->
<view class="container">
  <!-- ç¬”è®°åˆ—è¡¨ -->
  <view class="notes-wrapper" wx:if="{{notes.length > 0}}">
    <view 
      class="note-card" 
      wx:for="{{notes}}" 
      wx:key="id"
      bindtap="previewFile"
      data-url="{{item.fileUrl}}"
      data-type="{{item.fileType}}"
      data-title="{{item.title}}"
    >
      <view class="note-header">
        <view class="note-icon {{item.fileType === 'pdf' ? 'pdf' : 'word'}}">
          <text>{{item.fileType === 'pdf' ? 'ğŸ“„' : 'ğŸ“'}}</text>
        </view>
        <view class="note-info">
          <text class="note-title">{{item.title}}</text>
          <text class="note-type">{{item.fileType === 'pdf' ? 'PDF' : 'Word'}} æ–‡æ¡£</text>
        </view>
      </view>
      
      <view class="note-description" wx:if="{{item.description}}">
        <text>{{item.description}}</text>
      </view>
      
      <view class="note-footer">
        <text class="note-size">å¤§å°ï¼š{{formatFileSize(item.fileSize)}}</text>
        <text class="note-time">{{item.createdAt}}</text>
      </view>
    </view>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading" wx:if="{{loading && page === 1}}">
    <text>åŠ è½½ä¸­...</text>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty" wx:if="{{!loading && notes.length === 0}}">
    <view class="empty-icon">ğŸ“š</view>
    <view class="empty-text">æš‚æ— ç¬”è®°</view>
  </view>

  <!-- åŠ è½½æ›´å¤š -->
  <view class="load-more" wx:if="{{notes.length > 0}}">
    <text wx:if="{{loading}}">åŠ è½½ä¸­...</text>
    <text wx:elif="{{!hasMore}}">æ²¡æœ‰æ›´å¤šäº†</text>
  </view>
</view>

<wxs module="utils">
  var formatFileSize = function(bytes) {
    if (!bytes) return "-";
    var k = 1024;
    var sizes = ["B", "KB", "MB", "GB"];
    var i = Math.floor(Math.log(bytes) / Math.log(k));
    return Math.round((bytes / Math.pow(k, i)) * 100) / 100 + " " + sizes[i];
  };
  
  module.exports = {
    formatFileSize: formatFileSize
  };
</wxs>

