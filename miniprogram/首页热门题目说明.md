# 📱 首页热门题目功能说明

## ✅ 已完成的修改

### 1. 使用真实数据
- ✅ 从后端 API 获取题目数据：`GET /api/v1/questions?page=1&limit=3`
- ✅ 替换了原来的模拟数据

### 2. 限制显示数量
- ✅ 最多显示 **3 条**题目
- ✅ 即使后端返回更多数据，前端也会切片取前3条

### 3. 增强用户体验
- ✅ 添加加载状态处理
- ✅ 添加错误处理（网络错误、数据错误）
- ✅ 添加空状态提示（无数据时显示友好提示）
- ✅ 添加 emoji 图标，界面更生动
- ✅ 添加点击动画效果

---

## 📋 数据流程

```
首页加载 (onLoad)
    ↓
调用 loadQuestions()
    ↓
发送请求: GET /api/v1/questions?page=1&limit=3
    ↓
后端返回数据
    ↓
前端处理: questions.slice(0, 3) 确保最多3条
    ↓
渲染到页面
```

---

## 🧪 如何测试

### 前置条件
1. 确保后端服务运行在 `http://localhost:3000`
2. 确保数据库中有题目数据

### 测试步骤

#### 步骤 1：准备测试数据
在管理后台添加至少 3-5 个题目，确保有测试数据。

#### 步骤 2：启动微信开发者工具
```bash
# 1. 在微信开发者工具中打开 miniprogram 文件夹
# 2. 点击编译/刷新
```

#### 步骤 3：查看效果

**场景一：有数据（正常情况）**
- 首页应该显示最多 3 条题目
- 每条题目包含：标题、内容、难度标签、分类、题目类型
- 点击题目可以跳转到详情页

**场景二：少于3条数据**
- 如果数据库只有 1-2 条题目
- 首页显示实际数量（1 或 2 条）

**场景三：无数据**
- 如果数据库没有题目
- 显示空状态提示：
  ```
  📝
  暂无题目数据
  请先在管理后台添加题目
  ```

**场景四：网络错误**
- 如果后端服务未启动
- 控制台会显示错误信息
- 页面显示空状态

---

## 🔍 调试技巧

### 1. 查看控制台日志
打开微信开发者工具的控制台，查看以下日志：

```javascript
// 请求日志
"首页热门题目返回:" { statusCode: 200, data: {...} }

// 错误日志
"加载题目失败:" "错误信息"
"加载题目网络错误:" {...}
```

### 2. 检查数据格式
确保后端返回的数据格式正确：

```json
{
  "code": 200,
  "data": {
    "list": [
      {
        "id": 1,
        "title": "题目标题",
        "content": "题目内容",
        "type": "single",      // single | multiple | fill | essay
        "difficulty": "easy",  // easy | medium | hard
        "category": "数学"
      }
    ],
    "total": 10,
    "page": 1,
    "limit": 3
  }
}
```

### 3. 检查网络请求
在控制台的 Network 标签页中查看：
- 请求 URL: `http://localhost:3000/api/v1/questions?page=1&limit=3`
- 请求方法: GET
- 状态码: 200

---

## 🐛 常见问题

### Q1: 首页不显示题目？
**A:** 检查以下几点：
1. 后端服务是否运行？访问 http://localhost:3000 确认
2. 数据库中是否有题目数据？
3. 控制台是否有错误信息？
4. API 地址配置是否正确？查看 `app.js` 中的 `apiBaseUrl`

### Q2: 显示超过3条题目？
**A:** 不应该出现这种情况，因为代码中有两层保护：
- 请求参数：`limit: 3`
- 数据切片：`questions.slice(0, 3)`

如果出现，请检查代码是否被修改。

### Q3: 点击题目没反应？
**A:** 检查：
1. 详情页路径是否正确：`pages/questions/detail/detail`
2. 题目是否有 id 字段？
3. 控制台是否有导航错误？

### Q4: 样式显示不正常？
**A:** 
1. 检查 `index.wxss` 是否正确加载
2. 清除缓存重新编译
3. 检查是否有 CSS 冲突

---

## 📱 完整功能预览

### 首页展示
```
┌─────────────────────────────┐
│     [轮播图]                 │
├─────────────────────────────┤
│  🔥 热门题目        更多 >   │
├─────────────────────────────┤
│  ┌──────────────────────┐   │
│  │ 数学基础题       [简单]│   │
│  │ 计算下列式子的值...   │   │
│  │ 📚 数学  📝 单选题   │   │
│  └──────────────────────┘   │
│  ┌──────────────────────┐   │
│  │ 英语语法题       [中等]│   │
│  │ Choose the correct...│   │
│  │ 📚 英语  ✅ 多选题   │   │
│  └──────────────────────┘   │
│  ┌──────────────────────┐   │
│  │ 物理概念题       [困难]│   │
│  │ 解释牛顿第一定律...  │   │
│  │ 📚 物理  📖 简答题   │   │
│  └──────────────────────┘   │
└─────────────────────────────┘
```

---

## 🎯 下一步优化建议

1. **添加下拉刷新**
   - 允许用户下拉刷新首页数据

2. **添加骨架屏**
   - 加载时显示骨架屏动画

3. **添加缓存机制**
   - 缓存热门题目，减少网络请求

4. **题目排序优化**
   - 按热度、难度、最新等维度排序

5. **添加筛选功能**
   - 按分类筛选热门题目

---

## 📝 代码文件清单

修改的文件：
- ✅ `pages/index/index.js` - 逻辑代码
- ✅ `pages/index/index.wxml` - 模板代码
- ✅ `pages/index/index.wxss` - 样式代码

依赖的文件：
- `app.js` - API 配置
- `pages/questions/detail/detail.*` - 详情页

---

## 💡 温馨提示

- 首页数据会在 `onLoad` 和 `onShow` 时自动刷新
- 点击"更多"会跳转到题目列表页（显示全部题目）
- 确保后端接口已经修复了之前的 `undefined` 参数问题
- 建议在数据库中准备至少 5 条以上的题目以便测试

